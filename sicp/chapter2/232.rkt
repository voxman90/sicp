#lang sicp

#|
  ะฃะฟัะฐะถะฝะตะฝะธะต 2.32

  ะะฝะพะถะตััะฒะพ ะผะพะถะฝะพ ะฟัะตะดััะฐะฒะธัั ะบะฐะบ ัะฟะธัะพะบ ะตะณะพ ัะฐะทะปะธัะฝัั ัะปะตะผะตะฝัะพะฒ, ะฐ ะผะฝะพะถะตััะฒะพ ะตะณะพ ะฟะพะดะผะฝะพะถะตััะฒ ะบะฐะบ ัะฟะธัะพะบ
  ัะฟะธัะบะพะฒ. ะะฐะฟัะธะผะตั, ะตัะปะธ ะผะฝะพะถะตััะฒะพ ัะฐะฒะฝะพ (1 2 3), ัะพ ะผะฝะพะถะตััะฒะพ ะตะณะพ ะฟะพะดะผะฝะพะถะตััะฒ ัะฐะฒะฝะพ (() (3) (2) (2 3)
  (1) (1 3) (1 2) (1 2 3)). ะะฐะบะพะฝัะธัะต ัะปะตะดัััะตะต ะพะฟัะตะดะตะปะตะฝะธะต ะฟัะพัะตะดััั, ะบะพัะพัะฐั ะฟะพัะพะถะดะฐะตั ะผะฝะพะถะตััะฒะพ
  ะฟะพะดะผะฝะพะถะตััะฒ ะธ ะดะฐะนัะต ััะฝะพะต ะพะฑัััะฝะตะฝะธะต, ะฟะพัะตะผั ะพะฝะฐ ัะฐะฑะพัะฐะตั:

    (define (subsets s)
      (if (null? s)
          (list nil)
          (let ((rest (subsets (cdr s))))
            (append rest (map <??> rest)))))
|#

(#%require rackunit)

(define nil '())

(define (subsets s)
  (if (null? s)
      (list nil)
      (let ((rest (subsets (cdr s))))
           (append rest (map (lambda (set) (cons (car s) set))
                             rest)))))

(check-equal? (subsets '()) '(()))
(check-equal? (subsets '(1 2 3)) '(() (3) (2) (2 3) (1) (1 3) (1 2) (1 2 3)))
(check-equal? (subsets '("a" (3) (())))
              '(() ((())) ((3)) ((3) (())) ("a") ("a" (())) ("a" (3)) ("a" (3) (()))))

#|
  ะะฝะพะถะตััะฒะพ ะฒัะตั ะฟะพะดะผะฝะพะถะตััะฒ ะผะฝะพะถะตััะฒะฐ A - ๐ซ(ะ), ะณะดะต |A| = n, ะผะพะถะฝะพ ัะฐััะผะฐััะธะฒะฐัั ะบะฐะบ ะพะฑัะตะดะธะฝะตะฝะธะต
  ๐ซ(B), ะณะดะต B โ A ะธ |B| = n - 1, ั โชโ{ะโB โช X}, ะดะปั โX โ ๐ซ(B).

  A = {a, b}, ะฒะพะทัะผัะผ ะฒ ะบะฐัะตััะฒะต ะฟะพะดะผะฝะพะถะตััะฒะฐ B = {b}. ะกะฟะตัะฒะฐ ะฟะพััะธัะฐะตะผ ะตะณะพ ะฟะพะดะผะฝะพะถะตััะฒะฐ. B = {b},
  C = {}. ะะปั n = 0 ะผั ะฟะพะปััะฐะตะผ ะฟัััะพะต ะผะฝะพะถะตััะฒะพ, ะฐ ๐ซ({}) = {{}}.

  ะขะตะฟะตัั ะฒะตัะฝัะผัั ะบ n = 1. ะะฝะพะถะตััะฒะพ ะฒัะตั ะฟะพะดะผะฝะพะถะตััะฒ ๐ซ(B) = ๐ซ(ะก) โช โชโ{BโC โช X}, โX โ ๐ซ(C):

    ๐ซ(B) = {{}} โช {{b} โช {}} = {{}, {b}}

  ะะตัะฝัะผัั ะบ n = 2. ะะฝะพะถะตััะฒะพ ะฒัะตั ะฟะพะดะผะฝะพะถะตััะฒ ๐ซ(A) = ๐ซ(B) โช โชโ{AโB โช X}, โX โ ๐ซ(B):

    ๐ซ(A) = {{}, {b}} โช {{a} โช {}, {a} โช {b}} = {{}, {b}, {a}, {a, b}}

  ะขะพั ะถะต ัะตะทัะปััะฐั ั ัะพัะบะธ ะทัะตะฝะธั ัะตะพัะธะธ ะผะฝะพะถะตััะฒ ะผั ะฑั ะฟะพะปััะธะปะธ, ะตัะปะธ ะฑั ัะฐััะผะฐััะธะฒะฐะปะธ ะฒ ะบะฐัะตััะฒะต
  ะฟะพะดะผะฝะพะถะตััะฒะฐ ะผะตะฝััะตะน ะผะพัะฝะพััะธ B = {a}.
|#

(check-equal? (subsets '("a" "b")) '(() ("b") ("a") ("a" "b")))
